import React, { useEffect } from 'react';
import { connect } from 'react-redux';

import { fetchPopular } from 'actions';
import { getApps } from 'selectors';

import AppList from 'components/AppList';
import Spinner from 'components/Spinner';
import ErrorIndicator from 'components/ErrorIndicator';

const Popular = props => {
  const { fetchPopular, apps, locationData, loading, error} = props;
  useEffect(() => {
    fetchPopular()
  }, [fetchPopular]);

  if(error) return <ErrorIndicator error={error} />;
  if(loading) return <Spinner />;

  return (
    <section className="popular__items">
      <div className="container">
        <h2>Popular games:</h2>
      </div>
        <AppList apps={apps} locationData={locationData}/>  
    </section>
  )
}

const mapStateToProps = (state, {page}) => ({
  apps: getApps(state, state[page].ids),
  loading: state[page].loading,
  error: state[page].error,
 });
 
 const mapDispatchToProps = {
  fetchPopular
 };
 
export default connect(mapStateToProps, mapDispatchToProps)(Popular);


